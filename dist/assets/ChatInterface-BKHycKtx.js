import{r as B,g as ct,j as n,i as ut,L as Ce}from"./index-CkpA-zjz.js";const ke={un:1,una:1,uno:1,dos:2,tres:3,cuatro:4,cinco:5,seis:6,siete:7,ocho:8,nueve:9,diez:10,once:11,doce:12,veinte:20,media:.5,medio:.5};function Z(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/(\d+)\s*punto\s*(\d+)/g,"$1.$2")}function lt(e){const t=/\$\s*(\d+(\.\d+)?)/,r=e.match(t);if(r){const v=parseFloat(r[1]),c=e.replace(r[0],"").trim();return{price:v,textWithoutPrice:c}}const u=/(\d+(\.\d+)?)\s*(dolares|dólares|pesos|usd)/i,m=e.match(u);if(m){const v=parseFloat(m[1]),c=e.replace(m[0],"").trim();return{price:v,textWithoutPrice:c}}return{price:null,textWithoutPrice:e}}function dt(e){e=e.trim();const t=e.match(/^(\d+(\.\d+)?)\s*/);if(t)return{quantity:parseFloat(t[1]),remainingText:e.substring(t[0].length)};const r=e.split(" "),u=Z(r[0]);return ke[u]?{quantity:ke[u],remainingText:e.substring(r[0].length).trim()}:{quantity:1,remainingText:e}}function _e(e,t){const r=Z(e);let u=null,m=0;for(const v of t)for(const c of v.keywords){const y=Z(c);r.includes(y)&&y.length>m&&(m=y.length,u=v)}return u}const pt=async(e,t)=>{await new Promise(l=>setTimeout(l,400));const r=Z(e);if((r.includes("precio")||r.includes("cuanto cuesta")||r.includes("vale"))&&!/\d/.test(r)){const l=_e(e,t);return l?{response:`El precio de ${l.name} es $${l.price.toFixed(2)} por ${l.unit}.`}:{response:"Lo siento, no encontré ese producto en la lista de precios. Intenta usar el nombre exacto o una palabra clave."}}const m=e.split(/,|\ny\s|\sy\s|\n/g).filter(l=>l.trim().length>0),v=[];let c=0,y=0;for(const l of m){const C=l.replace(/\./g,"").trim();if(!C)continue;const{price:d,textWithoutPrice:w}=lt(C),{quantity:s,remainingText:i}=dt(w),o=i.replace(/^\s*de\s+/i,"").trim(),h=_e(o,t);if(h){const p=d!==null?d:h.price,f=s*p;v.push({quantity:`${s} ${s>1&&h.unit!=="lb"?h.unit+"s":h.unit}`,product:h.name+(d!==null?" (Precio manual)":""),unit_price:p,subtotal:f}),c+=f,y++}else if(d!==null){const p=o.length>0?o.charAt(0).toUpperCase()+o.slice(1):"Varios",f=s*d;v.push({quantity:s.toString(),product:p,unit_price:d,subtotal:f}),c+=f,y++}}return y>0?{items:v,total_items:v.length,grand_total:c}:{response:"No pude identificar productos ni precios en tu mensaje. Intenta decir algo como '2 chulas', 'ciruela', o '$2 de pan'."}};var ie={},Me={},M={};Object.defineProperty(M,"__esModule",{value:!0});M.browserSupportsPolyfills=M.compareTwoStringsUsingDiceCoefficient=M.commandToRegExp=M.concatTranscripts=M.debounce=void 0;var ht=function(t,r,u){var m;return function(){var v=this,c=arguments,y=function(){m=null,u||t.apply(v,c)},l=u&&!m;clearTimeout(m),m=setTimeout(y,r),l&&t.apply(v,c)}};M.debounce=ht;var ft=function(){for(var t=arguments.length,r=new Array(t),u=0;u<t;u++)r[u]=arguments[u];return r.map(function(m){return m.trim()}).join(" ").trim()};M.concatTranscripts=ft;var gt=/\s*\((.*?)\)\s*/g,mt=/(\(\?:[^)]+\))\?/g,vt=/(\(\?)?:\w+/g,bt=/\*/g,yt=/[-{}[\]+?.,\\^$|#]/g,wt=function(t){return t instanceof RegExp?new RegExp(t.source,"i"):(t=t.replace(yt,"\\$&").replace(gt,"(?:$1)?").replace(vt,function(r,u){return u?r:"([^\\s]+)"}).replace(bt,"(.*?)").replace(mt,"\\s*$1?\\s*"),new RegExp("^"+t+"$","i"))};M.commandToRegExp=wt;var xt=function(t,r){if(t=t.replace(/\s+/g,"").toLowerCase(),r=r.replace(/\s+/g,"").toLowerCase(),!t.length&&!r.length)return 1;if(!t.length||!r.length)return 0;if(t===r)return 1;if(t.length===1&&r.length===1||t.length<2||r.length<2)return 0;for(var u=new Map,m=0;m<t.length-1;m++){var v=t.substring(m,m+2),c=u.has(v)?u.get(v)+1:1;u.set(v,c)}for(var y=0,l=0;l<r.length-1;l++){var C=r.substring(l,l+2),d=u.has(C)?u.get(C):0;d>0&&(u.set(C,d-1),y++)}return 2*y/(t.length+r.length-2)};M.compareTwoStringsUsingDiceCoefficient=xt;var St=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};M.browserSupportsPolyfills=St;var G={},V={};Object.defineProperty(V,"__esModule",{value:!0});V.APPEND_TRANSCRIPT=V.CLEAR_TRANSCRIPT=void 0;var Tt="CLEAR_TRANSCRIPT";V.CLEAR_TRANSCRIPT=Tt;var Rt="APPEND_TRANSCRIPT";V.APPEND_TRANSCRIPT=Rt;Object.defineProperty(G,"__esModule",{value:!0});G.appendTranscript=G.clearTranscript=void 0;var Ae=V,Ct=function(){return{type:Ae.CLEAR_TRANSCRIPT}};G.clearTranscript=Ct;var kt=function(t,r){return{type:Ae.APPEND_TRANSCRIPT,payload:{interimTranscript:t,finalTranscript:r}}};G.appendTranscript=kt;var ee={};Object.defineProperty(ee,"__esModule",{value:!0});ee.transcriptReducer=void 0;var je=V,_t=M,jt=function(t,r){switch(r.type){case je.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case je.APPEND_TRANSCRIPT:return{interimTranscript:r.payload.interimTranscript,finalTranscript:(0,_t.concatTranscripts)(t.finalTranscript,r.payload.finalTranscript)};default:throw new Error}};ee.transcriptReducer=jt;var Pe={},se={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=t})(se);var ae={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var t=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),r=function(v){return v===t};e.isNative=r;var u=t;e.default=u})(ae);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=m(se),r=M,u=ae;function m(w){return w&&w.__esModule?w:{default:w}}function v(w,s,i,o,h,p,f){try{var T=w[p](f),N=T.value}catch(F){i(F);return}T.done?s(N):Promise.resolve(N).then(o,h)}function c(w){return function(){var s=this,i=arguments;return new Promise(function(o,h){var p=w.apply(s,i);function f(N){v(p,o,h,f,T,"next",N)}function T(N){v(p,o,h,f,T,"throw",N)}f(void 0)})}}function y(w,s){if(!(w instanceof s))throw new TypeError("Cannot call a class as a function")}function l(w,s){for(var i=0;i<s.length;i++){var o=s[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(w,o.key,o)}}function C(w,s,i){return s&&l(w.prototype,s),w}var d=function(){function w(s){y(this,w),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(s),(0,t.default)()&&(this.updateFinalTranscript=(0,r.debounce)(this.updateFinalTranscript,250,!0))}return C(w,[{key:"setSpeechRecognition",value:function(i){var o=!!i&&((0,u.isNative)(i)||(0,r.browserSupportsPolyfills)());o&&(this.disableRecognition(),this.recognition=new i,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(o)}},{key:"subscribe",value:function(i,o){this.subscribers[i]=o}},{key:"unsubscribe",value:function(i){delete this.subscribers[i]}},{key:"emitListeningChange",value:function(i){var o=this;this.listening=i,Object.keys(this.subscribers).forEach(function(h){var p=o.subscribers[h].onListeningChange;p(i)})}},{key:"emitMicrophoneAvailabilityChange",value:function(i){var o=this;this.isMicrophoneAvailable=i,Object.keys(this.subscribers).forEach(function(h){var p=o.subscribers[h].onMicrophoneAvailabilityChange;p(i)})}},{key:"emitTranscriptChange",value:function(i,o){var h=this;Object.keys(this.subscribers).forEach(function(p){var f=h.subscribers[p].onTranscriptChange;f(i,o)})}},{key:"emitClearTranscript",value:function(){var i=this;Object.keys(this.subscribers).forEach(function(o){var h=i.subscribers[o].onClearTranscript;h()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(i){var o=this;Object.keys(this.subscribers).forEach(function(h){var p=o.subscribers[h],f=p.onBrowserSupportsSpeechRecognitionChange,T=p.onBrowserSupportsContinuousListeningChange;f(i),T(i)})}},{key:"disconnect",value:function(i){if(this.recognition&&this.listening)switch(i){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(i){i&&i.error&&i.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(i){var o=i.results,h=i.resultIndex,p=h===void 0?o.length-1:h;this.interimTranscript="",this.finalTranscript="";for(var f=p;f<o.length;++f)o[f].isFinal&&(!(0,t.default)()||o[f][0].confidence>0)?this.updateFinalTranscript(o[f][0].transcript):this.interimTranscript=(0,r.concatTranscripts)(this.interimTranscript,o[f][0].transcript);var T=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(T=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,T||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(i){this.finalTranscript=(0,r.concatTranscripts)(this.finalTranscript,i)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var s=c(regeneratorRuntime.mark(function o(){var h,p,f,T,N,F,H=arguments;return regeneratorRuntime.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:if(h=H.length>0&&H[0]!==void 0?H[0]:{},p=h.continuous,f=p===void 0?!1:p,T=h.language,this.recognition){R.next=3;break}return R.abrupt("return");case 3:if(N=f!==this.recognition.continuous,F=T&&T!==this.recognition.lang,!(N||F)){R.next=11;break}if(!this.listening){R.next=9;break}return R.next=9,this.stopListening();case 9:this.recognition.continuous=N?f:this.recognition.continuous,this.recognition.lang=F?T:this.recognition.lang;case 11:if(this.listening){R.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),R.prev=13,R.next=16,this.start();case 16:this.emitListeningChange(!0),R.next=22;break;case 19:R.prev=19,R.t0=R.catch(13),R.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return R.stop()}},o,this,[[13,19]])}));function i(){return s.apply(this,arguments)}return i}()},{key:"abortListening",value:function(){var s=c(regeneratorRuntime.mark(function o(){var h=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),f.next=4,new Promise(function(T){h.onStopListening=T});case 4:case"end":return f.stop()}},o,this)}));function i(){return s.apply(this,arguments)}return i}()},{key:"stopListening",value:function(){var s=c(regeneratorRuntime.mark(function o(){var h=this;return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),f.next=4,new Promise(function(T){h.onStopListening=T});case 4:case"end":return f.stop()}},o,this)}));function i(){return s.apply(this,arguments)}return i}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var s=c(regeneratorRuntime.mark(function o(){return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!(this.recognition&&!this.listening)){p.next=4;break}return p.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return p.stop()}},o,this)}));function i(){return s.apply(this,arguments)}return i}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),w}();e.default=d})(Pe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var t=B,r=M,u=G,m=ee,v=l(Pe),c=l(se),y=l(ae);function l(a){return a&&a.__esModule?a:{default:a}}function C(a,b,g,x,k,S,_){try{var j=a[S](_),P=j.value}catch(z){g(z);return}j.done?b(P):Promise.resolve(P).then(x,k)}function d(a){return function(){var b=this,g=arguments;return new Promise(function(x,k){var S=a.apply(b,g);function _(P){C(S,x,k,_,j,"next",P)}function j(P){C(S,x,k,_,j,"throw",P)}_(void 0)})}}function w(a){return o(a)||i(a)||T(a)||s()}function s(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(a){if(typeof Symbol<"u"&&Symbol.iterator in Object(a))return Array.from(a)}function o(a){if(Array.isArray(a))return N(a)}function h(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(g){return typeof g}:h=function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},h(a)}function p(a,b){return H(a)||F(a,b)||T(a,b)||f()}function f(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function T(a,b){if(a){if(typeof a=="string")return N(a,b);var g=Object.prototype.toString.call(a).slice(8,-1);if(g==="Object"&&a.constructor&&(g=a.constructor.name),g==="Map"||g==="Set")return Array.from(a);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return N(a,b)}}function N(a,b){(b==null||b>a.length)&&(b=a.length);for(var g=0,x=new Array(b);g<b;g++)x[g]=a[g];return x}function F(a,b){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(a)))){var g=[],x=!0,k=!1,S=void 0;try{for(var _=a[Symbol.iterator](),j;!(x=(j=_.next()).done)&&(g.push(j.value),!(b&&g.length===b));x=!0);}catch(P){k=!0,S=P}finally{try{!x&&_.return!=null&&_.return()}finally{if(k)throw S}}return g}}function H(a){if(Array.isArray(a))return a}var q=!!y.default,R=q&&!(0,c.default)(),I,Ee=function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=b.transcribing,x=g===void 0?!0:g,k=b.clearTranscriptOnListen,S=k===void 0?!0:k,_=b.commands,j=_===void 0?[]:_,P=(0,t.useState)(D.getRecognitionManager()),z=p(P,1),W=z[0],Ie=(0,t.useState)(q),oe=p(Ie,2),De=oe[0],ze=oe[1],We=(0,t.useState)(R),ce=p(We,2),$e=ce[0],Be=ce[1],Fe=(0,t.useReducer)(m.transcriptReducer,{interimTranscript:W.interimTranscript,finalTranscript:""}),ue=p(Fe,2),le=ue[0],de=le.interimTranscript,pe=le.finalTranscript,he=ue[1],qe=(0,t.useState)(W.listening),fe=p(qe,2),Ue=fe[0],Ve=fe[1],Ge=(0,t.useState)(W.isMicrophoneAvailable),ge=p(Ge,2),He=ge[0],Qe=ge[1],me=(0,t.useRef)(j);me.current=j;var ve=function(){he((0,u.clearTranscript)())},Q=(0,t.useCallback)(function(){W.resetTranscript(),ve()},[W]),Ke=function(L,O,U){var $=h(L)==="object"?L.toString():L,K=$.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),X=(0,r.compareTwoStringsUsingDiceCoefficient)(K,O);return X>=U?{command:L,commandWithoutSpecials:K,howSimilar:X,isFuzzyMatch:!0}:null},Xe=function(L,O){var U=(0,r.commandToRegExp)(L),$=U.exec(O);return $?{command:L,parameters:$.slice(1)}:null},be=(0,t.useCallback)(function(E,L){me.current.forEach(function(O){var U=O.command,$=O.callback,K=O.matchInterim,X=K===void 0?!1:K,xe=O.isFuzzyMatch,Se=xe===void 0?!1:xe,Te=O.fuzzyMatchingThreshold,Ye=Te===void 0?.8:Te,Re=O.bestMatchOnly,Ze=Re===void 0?!1:Re,J=!L&&X?E.trim():L.trim(),et=Array.isArray(U)?U:[U],Y=et.map(function(A){return Se?Ke(A,J,Ye):Xe(A,J)}).filter(function(A){return A});if(Se&&Ze&&Y.length>=2){Y.sort(function(A,ne){return ne.howSimilar-A.howSimilar});var te=Y[0],tt=te.command,nt=te.commandWithoutSpecials,rt=te.howSimilar;$(nt,J,rt,{command:tt,resetTranscript:Q})}else Y.forEach(function(A){if(A.isFuzzyMatch){var ne=A.command,it=A.commandWithoutSpecials,st=A.howSimilar;$(it,J,st,{command:ne,resetTranscript:Q})}else{var at=A.command,ot=A.parameters;$.apply(void 0,w(ot).concat([{command:at,resetTranscript:Q}]))}})})},[Q]),ye=(0,t.useCallback)(function(E,L){x&&he((0,u.appendTranscript)(E,L)),be(E,L)},[be,x]),we=(0,t.useCallback)(function(){S&&ve()},[S]);(0,t.useEffect)(function(){var E=D.counter;D.counter+=1;var L={onListeningChange:Ve,onMicrophoneAvailabilityChange:Qe,onTranscriptChange:ye,onClearTranscript:we,onBrowserSupportsSpeechRecognitionChange:ze,onBrowserSupportsContinuousListeningChange:Be};return W.subscribe(E,L),function(){W.unsubscribe(E)}},[x,S,W,ye,we]);var Je=(0,r.concatTranscripts)(pe,de);return{transcript:Je,interimTranscript:de,finalTranscript:pe,listening:Ue,isMicrophoneAvailable:He,resetTranscript:Q,browserSupportsSpeechRecognition:De,browserSupportsContinuousListening:$e}};e.useSpeechRecognition=Ee;var D={counter:0,applyPolyfill:function(b){I?I.setSpeechRecognition(b):I=new v.default(b);var g=!!b&&(0,r.browserSupportsPolyfills)();q=g,R=g},removePolyfill:function(){I?I.setSpeechRecognition(y.default):I=new v.default(y.default),q=!!y.default,R=q&&!(0,c.default)()},getRecognitionManager:function(){return I||(I=new v.default(y.default)),I},getRecognition:function(){var b=D.getRecognitionManager();return b.getRecognition()},startListening:function(){var a=d(regeneratorRuntime.mark(function g(){var x,k,S,_,j=arguments;return regeneratorRuntime.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return x=j.length>0&&j[0]!==void 0?j[0]:{},k=x.continuous,S=x.language,_=D.getRecognitionManager(),z.next=4,_.startListening({continuous:k,language:S});case 4:case"end":return z.stop()}},g)}));function b(){return a.apply(this,arguments)}return b}(),stopListening:function(){var a=d(regeneratorRuntime.mark(function g(){var x;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return x=D.getRecognitionManager(),S.next=3,x.stopListening();case 3:case"end":return S.stop()}},g)}));function b(){return a.apply(this,arguments)}return b}(),abortListening:function(){var a=d(regeneratorRuntime.mark(function g(){var x;return regeneratorRuntime.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return x=D.getRecognitionManager(),S.next=3,x.abortListening();case 3:case"end":return S.stop()}},g)}));function b(){return a.apply(this,arguments)}return b}(),browserSupportsSpeechRecognition:function(){return q},browserSupportsContinuousListening:function(){return R}},Oe=D;e.default=Oe})(Me);(function(e){function t(c){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(l){return typeof l}:t=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},t(c)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return r.useSpeechRecognition}}),e.default=void 0;var r=m(Me);function u(){if(typeof WeakMap!="function")return null;var c=new WeakMap;return u=function(){return c},c}function m(c){if(c&&c.__esModule)return c;if(c===null||t(c)!=="object"&&typeof c!="function")return{default:c};var y=u();if(y&&y.has(c))return y.get(c);var l={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var d in c)if(Object.prototype.hasOwnProperty.call(c,d)){var w=C?Object.getOwnPropertyDescriptor(c,d):null;w&&(w.get||w.set)?Object.defineProperty(l,d,w):l[d]=c[d]}return l.default=c,y&&y.set(c,l),l}var v=r.default;e.default=v})(ie);const Le=ct(ie),Lt=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[n.jsx("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}),n.jsx("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),n.jsx("line",{x1:"12",y1:"19",x2:"12",y2:"22"})]}),Nt=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[n.jsx("line",{x1:"22",y1:"2",x2:"11",y2:"13"}),n.jsx("polygon",{points:"22 2 15 22 11 13 2 9 22 2"})]}),Mt=({onSendMessage:e,isLoading:t})=>{const[r,u]=B.useState(""),{transcript:m,listening:v,resetTranscript:c,browserSupportsSpeechRecognition:y}=ie.useSpeechRecognition();B.useEffect(()=>{if(m){let d=m.replace(/\b(\w+)( \1\b)+/gi,"$1");d=d.charAt(0).toUpperCase()+d.slice(1),u(d)}},[m]);const l=d=>{d.preventDefault(),r.trim()&&!t&&(e(r),u(""),c())},C=()=>{v?Le.stopListening():(u(""),c(),Le.startListening({continuous:!0,language:"es-MX"}))};return y?n.jsxs("form",{onSubmit:l,className:"flex items-center gap-2 md:gap-4 p-2 rounded-full bg-dark-surface border border-dark-border shadow-lg transition-all focus-within:ring-2 focus-within:ring-primary-500/50 focus-within:border-primary-500",children:[n.jsx("input",{type:"text",value:r,onChange:d=>u(d.target.value),placeholder:v?"Escuchando...":"Escribe tu pedido aquí...",className:"flex-1 bg-transparent focus:outline-none px-4 py-3 placeholder-slate-500 text-slate-200",disabled:t}),n.jsx("button",{type:"button",onClick:C,disabled:t,className:`p-3 rounded-full transition-all duration-300 ${v?"bg-red-500 text-white animate-pulse shadow-[0_0_15px_rgba(239,68,68,0.5)]":"bg-dark-bg hover:bg-dark-surface border border-dark-border text-slate-400 hover:text-primary-400"} disabled:opacity-50 disabled:cursor-not-allowed`,children:n.jsx(Lt,{className:"w-5 h-5"})}),n.jsx("button",{type:"submit",disabled:t||!r.trim(),className:"p-3 rounded-full bg-gradient-to-r from-primary-600 to-secondary-600 hover:from-primary-500 hover:to-secondary-500 disabled:from-slate-700 disabled:to-slate-700 disabled:cursor-not-allowed text-white shadow-lg shadow-primary-900/20 transform active:scale-95 transition-all duration-200",children:n.jsx(Nt,{className:"w-5 h-5"})})]}):n.jsx("span",{className:"text-slate-500 text-sm",children:"Navegador no compatible con voz."})},At=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[n.jsx("path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}),n.jsx("circle",{cx:"12",cy:"7",r:"4"})]}),Pt=e=>n.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:n.jsx("path",{d:"m12 3-1.9 5.8-5.8 1.9 5.8 1.9 1.9 5.8 1.9-5.8 5.8-1.9-5.8-1.9z"})}),re=e=>typeof e!="number"?"$0.00":`$${e.toFixed(2)}`,Et=()=>n.jsxs("div",{className:"flex items-center justify-center space-x-2 p-2",children:[n.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-400 animate-pulse [animation-delay:-0.3s]"}),n.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-400 animate-pulse [animation-delay:-0.15s]"}),n.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-400 animate-pulse"})]}),Ot=({invoice:e})=>n.jsxs("div",{className:"bg-dark-surface/50 rounded-xl text-slate-200 w-full max-w-md overflow-hidden border border-dark-border shadow-lg",children:[n.jsx("h3",{className:"text-lg font-semibold p-4 border-b border-dark-border text-primary-400 flex justify-between items-center bg-dark-surface/50",children:n.jsx("span",{children:"Factura de Pedido"})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full text-sm text-left",children:[n.jsx("thead",{className:"bg-dark-surface/80",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-2 font-medium text-slate-400",children:"Cant."}),n.jsx("th",{className:"px-4 py-2 font-medium text-slate-400",children:"Producto"}),n.jsx("th",{className:"px-4 py-2 font-medium text-right text-slate-400",children:"Subtotal"})]})}),n.jsx("tbody",{className:"divide-y divide-dark-border",children:e.items.map((t,r)=>n.jsxs("tr",{className:"hover:bg-dark-surface/30 transition-colors",children:[n.jsx("td",{className:"px-4 py-3 w-16 text-slate-300",children:t.quantity}),n.jsxs("td",{className:"px-4 py-3 font-medium text-white",children:[t.product,n.jsxs("div",{className:"text-xs text-slate-500",children:[re(t.unit_price)," c/u"]})]}),n.jsx("td",{className:"px-4 py-3 text-right font-mono text-primary-300 w-24",children:re(t.subtotal)})]},r))})]})}),n.jsx("div",{className:"p-4 bg-dark-surface/80 space-y-3 border-t border-dark-border",children:n.jsxs("div",{className:"flex justify-between items-center text-lg",children:[n.jsx("span",{className:"font-bold text-slate-300",children:"TOTAL:"}),n.jsx("span",{className:"font-bold text-2xl text-transparent bg-clip-text bg-gradient-to-r from-primary-400 to-secondary-400",children:re(e.grand_total)})]})})]}),Ne=({message:e})=>{const t=e.sender==="user",r=()=>e.isLoading?n.jsx(Et,{}):e.invoice?n.jsx(Ot,{invoice:e.invoice}):e.text?n.jsx("p",{className:"whitespace-pre-wrap leading-relaxed",children:e.text}):null,u=t?"bg-gradient-to-br from-primary-600 to-primary-700 text-white rounded-br-none":"bg-dark-surface border border-dark-border text-slate-200 rounded-bl-none",m=e.invoice?"p-0":"p-4";return n.jsxs("div",{className:`flex items-end gap-3 w-full ${t?"justify-end":"justify-start"} animate-fade-in`,children:[!t&&n.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gradient-to-br from-secondary-500 to-primary-500 flex items-center justify-center shadow-lg shadow-primary-900/20",children:n.jsx(Pt,{className:"w-5 h-5 text-white"})}),n.jsx("div",{className:`rounded-2xl ${u} ${m} max-w-lg shadow-md transition-all hover:shadow-lg`,role:"log","aria-live":t?"off":"polite",children:r()}),t&&n.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-dark-surface border border-dark-border flex items-center justify-center shadow-lg",children:n.jsx(At,{className:"w-5 h-5 text-slate-400"})})]})},It=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[n.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.1a2 2 0 0 1-1-1.72v-.51a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"}),n.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),Dt=e=>n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...e,children:[n.jsx("path",{d:"M3 3v18h18"}),n.jsx("path",{d:"m19 9-5 5-4-4-3 3"})]}),Wt=({products:e})=>{const[t,r]=B.useState([ut]),[u,m]=B.useState(!1),[v,c]=B.useState(null),y=B.useRef(null),l=()=>{var d;(d=y.current)==null||d.scrollIntoView({behavior:"smooth"})};B.useEffect(()=>{l()},[t]);const C=async d=>{if(!d.trim())return;const w={id:Date.now().toString(),sender:"user",text:d};r(s=>[...s,w]),m(!0),c(null);try{const s=await pt(d,e);let i;"items"in s&&"grand_total"in s?i={id:(Date.now()+1).toString(),sender:"ai",invoice:s}:i={id:(Date.now()+1).toString(),sender:"ai",text:s.response||"No pude procesar esa solicitud."},r(o=>[...o,i])}catch(s){const i="Lo siento, ocurrió un error al procesar tu solicitud.";c(i),r(o=>[...o,{id:(Date.now()+1).toString(),sender:"ai",text:i}]),console.error(s)}finally{m(!1)}};return n.jsxs("div",{className:"flex flex-col h-screen bg-dark-bg text-slate-100 font-sans overflow-hidden",children:[n.jsxs("div",{className:"fixed inset-0 pointer-events-none",children:[n.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[40%] h-[40%] bg-primary-900/20 rounded-full blur-[100px]"}),n.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[40%] h-[40%] bg-secondary-900/20 rounded-full blur-[100px]"})]}),n.jsxs("header",{className:"bg-dark-surface/80 backdrop-blur-md p-4 border-b border-dark-border shadow-lg sticky top-0 z-10 flex justify-between items-center",children:[n.jsx(Ce,{to:"/ventas",className:"p-2 text-slate-400 hover:text-primary-400 transition-all hover:bg-primary-500/10 rounded-lg",title:"Ver Ventas",children:n.jsx(Dt,{className:"w-6 h-6"})}),n.jsxs("div",{className:"text-center",children:[n.jsx("h1",{className:"text-xl md:text-2xl font-bold bg-gradient-to-r from-primary-400 to-secondary-400 bg-clip-text text-transparent font-heading",children:"Asistente de Tienda"}),n.jsx("p",{className:"text-xs text-slate-400 font-medium tracking-wide",children:"AI POWERED ASSISTANT"})]}),n.jsx(Ce,{to:"/admin",className:"p-2 text-slate-400 hover:text-secondary-400 transition-all hover:bg-secondary-500/10 rounded-lg",title:"Administración",children:n.jsx(It,{className:"w-6 h-6"})})]}),n.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 space-y-6 relative z-0 scroll-smooth",children:[t.map(d=>n.jsx(Ne,{message:d},d.id)),u&&n.jsx(Ne,{message:{id:"loading",sender:"ai",isLoading:!0}}),n.jsx("div",{ref:y})]}),n.jsxs("footer",{className:"p-4 bg-dark-surface/90 backdrop-blur-md border-t border-dark-border sticky bottom-0 z-10",children:[v&&n.jsx("p",{className:"text-red-400 text-center mb-2 text-sm animate-pulse",children:v}),n.jsx("div",{className:"max-w-4xl mx-auto",children:n.jsx(Mt,{onSendMessage:C,isLoading:u})})]})]})};export{Wt as default};
