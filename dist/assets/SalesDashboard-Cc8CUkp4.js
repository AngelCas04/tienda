import{r as i,a as j,b as $,j as e,L as F}from"./index-CkpA-zjz.js";const H=()=>{const[a,w]=i.useState(0),[y,m]=i.useState(0),[v,N]=i.useState(0),[k,c]=i.useState([]),[p,x]=i.useState([]),[u,g]=i.useState(!0),d=i.useCallback(async()=>{g(!0);try{const s=new Date,r=Date.now(),h=new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime(),t=await j(h,r);w(t.reduce((l,n)=>l+n.total,0)),c(t.sort((l,n)=>n.timestamp-l.timestamp));const o=s.getDay(),b=s.getDate()-o+(o===0?-6:1),z=new Date(s.setDate(b)).setHours(0,0,0,0);s.setTime(Date.now());const B=await j(z,r);m(B.reduce((l,n)=>l+n.total,0));const V=new Date(s.getFullYear(),s.getMonth(),1).getTime(),W=await j(V,r);N(W.reduce((l,n)=>l+n.total,0));const C=[];let f=0;for(let l=6;l>=0;l--){const n=new Date;n.setDate(n.getDate()-l),n.setHours(0,0,0,0);const E=n.getTime(),T=new Date(n);T.setHours(23,59,59,999);const I=T.getTime(),D=(await j(E,I)).reduce((R,O)=>R+O.total,0);D>f&&(f=D);const S=n.toLocaleDateString("es-MX",{weekday:"short"});C.push({day:S.charAt(0).toUpperCase()+S.slice(1,2),fullDay:S,total:D,height:0})}const A=C.map(l=>({...l,height:f>0?Math.round(l.total/f*100):0}));x(A)}catch(s){console.error("Error calculating sales totals",s)}finally{g(!1)}},[]);return i.useEffect(()=>{d()},[d]),{todayTotal:a,weekTotal:y,monthTotal:v,recentSales:k,weeklyData:p,addManualSale:async(s,r)=>{const h={date:new Date().toISOString(),timestamp:Date.now(),total:s,note:r||"Venta manual"};await $(h),await d()},refreshSales:d,isLoading:u}},Y=a=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:e.jsx("path",{d:"m15 18-6-6 6-6"})}),L=a=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),_=a=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[e.jsx("rect",{width:"16",height:"20",x:"4",y:"2",rx:"2"}),e.jsx("line",{x1:"8",x2:"16",y1:"6",y2:"6"}),e.jsx("line",{x1:"16",x2:"16",y1:"14",y2:"18"}),e.jsx("path",{d:"M16 10h.01"}),e.jsx("path",{d:"M12 10h.01"}),e.jsx("path",{d:"M8 10h.01"}),e.jsx("path",{d:"M12 14h.01"}),e.jsx("path",{d:"M8 14h.01"}),e.jsx("path",{d:"M12 18h.01"}),e.jsx("path",{d:"M8 18h.01"})]}),G=a=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[e.jsx("path",{d:"M18 20V10"}),e.jsx("path",{d:"M12 20V4"}),e.jsx("path",{d:"M6 20v-6"})]}),P=a=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...a,children:[e.jsx("path",{d:"M5 12h14"}),e.jsx("path",{d:"M12 5v14"})]}),q=()=>{const{todayTotal:a,weekTotal:w,monthTotal:y,recentSales:m,weeklyData:v,addManualSale:N,isLoading:k}=H(),[c,p]=i.useState("register"),[x,u]=i.useState(""),[g,d]=i.useState(!1),M=async t=>{t.preventDefault();const o=parseFloat(x);o>0&&(await N(o,"Venta manual"),u(""))},s=()=>{d(!0),setTimeout(()=>{d(!1)},3500)},r=t=>`$${t.toFixed(2)}`,h=t=>new Date(t).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return k?e.jsx("div",{className:"h-screen flex items-center justify-center bg-slate-900 text-cyan-500",children:"Cargando finanzas..."}):e.jsxs("div",{className:"min-h-screen bg-slate-900 text-slate-100 pb-20 relative overflow-hidden",children:[e.jsxs("header",{className:"bg-slate-800 p-4 sticky top-0 z-10 shadow-md flex items-center gap-3",children:[e.jsx(F,{to:"/",className:"p-2 rounded-full hover:bg-slate-700 text-slate-400 hover:text-white transition-colors",children:e.jsx(Y,{className:"w-6 h-6"})}),e.jsx("h1",{className:"text-xl font-bold text-cyan-400",children:"Gestión de Ventas"})]}),e.jsxs("div",{className:"flex border-b border-slate-700 bg-slate-800/50",children:[e.jsxs("button",{onClick:()=>p("register"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${c==="register"?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(_,{className:"w-4 h-4"})," Caja"]}),e.jsxs("button",{onClick:()=>p("dashboard"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${c==="dashboard"?"text-cyan-400 border-b-2 border-cyan-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(G,{className:"w-4 h-4"})," Dashboard"]})]}),e.jsxs("main",{className:"p-4 max-w-md mx-auto space-y-6",children:[c==="register"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800 to-slate-900 p-6 rounded-2xl border border-slate-700 shadow-xl text-center",children:[e.jsx("p",{className:"text-slate-400 text-sm uppercase tracking-wider font-semibold",children:"Ventas de Hoy"}),e.jsx("p",{className:"text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-cyan-400 mt-2",children:r(a)})]}),e.jsxs("form",{onSubmit:M,className:"bg-slate-800 p-5 rounded-xl border border-slate-700 shadow-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Registro Rápido"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",value:x,onChange:t=>u(t.target.value),placeholder:"0.00",className:"w-full bg-slate-900 border border-slate-600 rounded-lg py-3 pl-8 pr-4 text-white focus:border-cyan-500 focus:ring-1 focus:ring-cyan-500 focus:outline-none transition-all text-lg"})]}),e.jsx("button",{type:"submit",disabled:!x,className:"bg-cyan-600 hover:bg-cyan-500 disabled:bg-slate-700 disabled:text-slate-500 text-white p-3 rounded-lg transition-colors shadow-lg shadow-cyan-900/20",children:e.jsx(P,{className:"w-6 h-6"})})]})]}),e.jsxs("button",{onClick:s,className:"w-full py-4 bg-slate-800 hover:bg-slate-700 border border-slate-600 rounded-xl text-slate-300 font-medium flex items-center justify-center gap-2 transition-all shadow-md hover:shadow-lg group",children:[e.jsx(L,{className:"w-5 h-5 text-green-500 group-hover:scale-110 transition-transform"}),"Realizar Corte de Caja"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider",children:"Recientes"}),e.jsx("div",{className:"bg-slate-800 rounded-xl overflow-hidden border border-slate-700 shadow-md",children:m.length===0?e.jsx("p",{className:"p-4 text-center text-slate-500 text-sm",children:"No hay ventas hoy."}):e.jsx("ul",{className:"divide-y divide-slate-700",children:m.map(t=>{var o,b;return e.jsxs("li",{className:"p-4 flex justify-between items-center hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-slate-200",children:((b=(o=t.items)==null?void 0:o[0])==null?void 0:b.product)||"Venta Manual"}),e.jsx("p",{className:"text-xs text-slate-500",children:h(t.timestamp)})]}),e.jsx("span",{className:"font-bold text-green-400",children:r(t.total)})]},t.id)})})})]})]}),c==="dashboard"&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"bg-slate-800 p-5 rounded-xl border border-slate-700 shadow-lg",children:[e.jsx("h3",{className:"text-slate-400 text-sm font-bold mb-4 uppercase",children:"Ventas Últimos 7 Días"}),e.jsx("div",{className:"h-48 flex items-end justify-between gap-2",children:v.map((t,o)=>e.jsxs("div",{className:"flex flex-col items-center gap-2 flex-1 group",children:[e.jsxs("div",{className:"w-full bg-slate-700/30 rounded-t-md relative h-32 flex items-end justify-center",children:[e.jsx("div",{className:"w-full bg-cyan-500 rounded-t-sm transition-all duration-500 hover:bg-cyan-400 relative group-hover:shadow-[0_0_10px_rgba(6,182,212,0.5)]",style:{height:`${Math.max(t.height,5)}%`}}),e.jsx("div",{className:"absolute -top-8 bg-slate-900 text-white text-xs py-1 px-2 rounded opacity-0 group-hover:opacity-100 transition-opacity border border-slate-600 whitespace-nowrap z-10 pointer-events-none",children:r(t.total)})]}),e.jsx("span",{className:"text-xs text-slate-400 font-medium",children:t.day})]},o))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 shadow-md",children:[e.jsx("p",{className:"text-slate-500 text-xs uppercase font-bold",children:"Semana"}),e.jsx("p",{className:"text-xl font-bold text-white mt-1",children:r(w)})]}),e.jsxs("div",{className:"bg-slate-800 p-4 rounded-xl border border-slate-700 shadow-md",children:[e.jsx("p",{className:"text-slate-500 text-xs uppercase font-bold",children:"Mes"}),e.jsx("p",{className:"text-xl font-bold text-white mt-1",children:r(y)})]})]})]})]}),g&&e.jsx("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-slate-900/95 backdrop-blur-md animate-fade-in",children:e.jsxs("div",{className:"bg-white text-slate-900 p-8 rounded-sm shadow-2xl max-w-sm w-full transform animate-receipt-print relative",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 h-4 bg-slate-900/95 -mt-2 clip-path-zigzag"}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-green-500 rounded-full flex items-center justify-center mx-auto animate-bounce",children:e.jsx(L,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-2xl font-bold uppercase tracking-widest",children:"Corte Exitoso"}),e.jsxs("div",{className:"border-y-2 border-dashed border-slate-300 py-4 my-4",children:[e.jsx("p",{className:"text-sm text-slate-500 uppercase",children:"Total del Día"}),e.jsx("p",{className:"text-4xl font-black font-mono mt-1",children:r(a)})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Caja cuadrada correctamente"})]}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-4 bg-slate-900/95 -mb-2 clip-path-zigzag rotate-180"})]})}),e.jsx("style",{children:`
                @keyframes receipt-print {
                    0% { transform: translateY(-50px); opacity: 0; }
                    100% { transform: translateY(0); opacity: 1; }
                }
                .clip-path-zigzag {
                    background-image: linear-gradient(135deg, #0f172a 25%, transparent 25%), linear-gradient(225deg, #0f172a 25%, transparent 25%);
                    background-position: 0 0;
                    background-size: 20px 20px;
                }
            `})]})};export{q as default};
